<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="http://cdn.pubnub.com/pubnub-3.14.5.min.js"></script>
        <style type="text/css">
         #imageCanvas {
          margin: 0 auto;
         }
       </style>
    </head>
    <body>
      <canvas id="imageCanvas" width='800' height='600'></canvas>
      <script>
        (function() {
          var ctx = document.getElementById('imageCanvas').getContext('2d');
          const pubnub = PUBNUB({
              subscribe_key : 'sub-c-b507301c-216b-11e6-8b91-02ee2ddab7fe',
          });
          pubnub.subscribe({
            channel : 'camguard:newimage',
            message : function (image) {
              var img = new Image();
              img.onload = function(){
                ctx.clearRect(0, 0, 800, 600);
                ctx.drawImage(img,0,0, 800, 600);
              };
              img.src = `http://localhost:1985/${image}.jpg?date=${new Date().getTime()}`;
            },
          });
        })();
      </script>
    </body>
</html>
